# terraform_provider_automation

### Description - 
- Creating terraform plugins have a lot of repetitive code which remains the same while development of different resources. So to make the development of resource plugins we have scripted an automation code which accepts a config.json file with various dynamic parameters related to the resource based on its API documentation. These parameters could be like function names or if the name is used for respective resources or not etc.

- So the output of this automation script is to create some resource functions so the process of developing terraform plugin can be fast and easy.

- Input for automation script.
Config.json :-

``` 
{
    "func_name" : "ServiceGroup",
    "methods" : ["Create", "Read", "Update", "Delete"],
    "name_key_value" : "name := d.Get('name').(string)",
    "data_to_func" : "dataToSg",
    "data_to_func_params" : "name, d",
    "set_id_params" : "name",
    "get_func_params" : "client.Token, name, client.Host",
    "name" : true,
    "struct_instance" : "ServiceGroup",
    "axapi_url" : "slb/service-group",

    "test_params": {"config_name":"SG",
   				 "test_check_func": true,
   				 "check_destroy": true,
   				 "resource_attrs": ["'vthunder_service_group.sg9'", ["'name', NAME_SG", "'ip_mask', MASK",
   				   "protocol', 'TCP'", "'10.0.2.9'", "'ip_nexthop_ipv4.0.distance_nexthop_ip', '1'"]],
   				 "resource_name": "NAME_SG",
   				 "create_import": true
   			 }

}
```

#### Param Name	Description	Example
- func_name	The resource name. i.e, - resourceServiceGroupCreate	ServiceGroup
- Methods	List of functions to create.	["Create", "Read", "Update", "Delete"]
- Name_key_value	If the resource has a name parameter.	"name := d.Get('name').(string)"
- Data_to_func	Custom data to func name.	"dataToSg"
- Data_to_func_params	Parameters to feed data to func method.	
- Set_id_params	Parameters to set under ResourceData schema.	"name" or “strconv.Itoa(name)”
- Get_func_params	This is required for read function only, as the parameters are different like sometimes we provide an ID or sometimes we provide a name.	"client.Token, name, client.Host”
- Name	This is required to check if the resource have the name in it or works with the ID of the resource.	true or false
Struct_instance	Name of the struct instance we create to store the resource data.	ServiceGroup
- Axapi_url	It is the dynamic part of the URL i.e, after “axapi/v3/”	"slb/service-group"
#### Test_params		
- Config_name	TEST_{config_name}_RESOURCE, as the words TEST and RESOURCE are the static we can only provide the abbreviated name of function which we use for config.	
- Test_check_func	Boolean var to call check functions.	
- Check_destroy	Boolean var to call check functions.	
- Resource_attrs	This is required for various scenarios in acceptance testing.	["'vthunder_service_group.sg9'", ["'name', NAME_SG", "'ip_mask', MASK", "protocol', 'TCP'", "'10.0.2.9'", "'ip_nexthop_ipv4.0.distance_nexthop_ip', '1'"]]
- Resource_name	This is the resource name variable which we define.	NAME_SG
- Create_import	This is to create an import test as well.	true or false


### Output of automation script - 

3 different “.go” files will be created -
1)	Function_name.go - APIs caller file
2)	Resource_vthunder_function_name.go - Resource file
3)	Resource_vthunder_{}_test.go - Test file for automated tests.

Output of the 1st and 2nd file will be based on method parameters provided by user in config.json. If a user has provided only 2 methods then only 2 functions will be generated by the automation script in respective .go files.

## Go_struct_generate

-   This is a module written in java which helps to generate Go code for a structure which is mapped with the paramaters provided in the "tf" file.
-  ResourceUtil.java is an util class responsible to generate go code and accepts a Json string for input payload defined in Jsons.java.
  
### Usage
- Add the json structure of the input payload for an axapi for which a resource needs to be generated in the file "Jsons.java"
- Replace the reference of Jsonobject in "ResourceUtil.java" with the newly added constant variable in Jsons.java.
- Run the java class "ResourceUtil.java" using either cmd or any IDE.









